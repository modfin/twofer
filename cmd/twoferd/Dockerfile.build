FROM golang:1.24.6-alpine3.22 AS builder

RUN mkdir -p /go/src/twofer
WORKDIR /go/src/twofer

COPY . /go/src/twofer

RUN CGO_ENABLE=0 go build -ldflags="-s -w" -o /twoferd ./cmd/twoferd/main.go

FROM scratch
EXPOSE 8080
COPY --from=builder /twoferd /
CMD [ "/twoferd" ]
